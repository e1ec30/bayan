from itertools import chain
import angr
import detectors
import explorers

proj = angr.Project("./toybox")
entry_state = proj.factory.entry_state(args=["./toybox", "4040"])

heartdetect = detectors.HearbleedDetector()
heartdetect.attach(proj)

naive = explorers.NaiveExplorer(proj, entry_state)
naive.go(1)

# sim = proj.factory.simgr(entry_state)

# buggy_states = []

# while len(buggy_states) < 1:
#     try:
#         sim.step()
#     except detectors.BugFoundError as e:
#         print(e.state)

        
